# KakeiBon by Rust ユーザーマニュアル

**バージョン**: 1.1.0
**最終更新**: 2026-01-18 JST

---

## 目次

1. [はじめに](#はじめに)
2. [初期設定](#初期設定)
3. [基本操作](#基本操作)
4. [ユーザー管理](#ユーザー管理)
5. [費目管理](#費目管理)
6. [口座管理](#口座管理)
7. [店舗管理](#店舗管理)
8. [メーカー・商品管理](#メーカー・商品管理)
9. [入出金管理](#入出金管理)
10. [集計機能](#集計機能)
11. [ダッシュボード](#ダッシュボード)
12. [設定](#設定)
13. [トラブルシューティング](#トラブルシューティング)

---

## はじめに

KakeiBon by Rustは、個人の家計管理を支援するデスクトップアプリケーションです。

### 主な機能

- **入出金管理**: 収入・支出・振替の記録と管理
- **費目管理**: 3階層のカテゴリで支出を分類
- **口座管理**: 複数の口座残高を一元管理
- **店舗管理**: よく使う店舗を登録・管理
- **商品管理**: 購入商品とメーカーの記録
- **集計機能**: 日次・週次・月次・年次・期間別の集計
- **多言語対応**: 日本語・英語に対応
- **セキュリティ**: パスワード暗号化とデータ暗号化

### システム要件

- **OS**: Linux (Windows/macOS対応予定)
- **必須ソフトウェア**:
  - Rust 1.70以上
  - Node.js 18以上
  - SQLite 3.35以上
  - 各種システムライブラリ (詳細は[セットアップガイド](SETUP_GUIDE.md)参照)

---

## 初期設定

### 1. アプリケーションの起動

```bash
cd /path/to/KakeiBonByRust
./target/release/KakeiBon
```

### 2. 管理者アカウントの作成

初回起動時、**管理者セットアップ画面**が表示されます。

1. **ユーザー名**を入力（3-20文字、英数字とアンダースコア）
   - 例: `admin`、`myname`、`user_admin`
2. **パスワード**を入力（最低16文字）
   - 推奨: 大文字・小文字・数字・記号を組み合わせる
   - 例: `MySecurePass2024!@`
3. **「管理者を作成」**ボタンをクリック

✅ 管理者アカウントが作成され、自動的にログインします。

### 3. 初回ログイン後の確認事項

管理者ログイン後、以下が自動的に設定されます：

- **デフォルト費目**: 大分類（支出・収入・振替）、20の中分類、126の小分類
- **費目の多言語名**: 日本語・英語の費目名

必要に応じて、費目・口座・店舗などを追加・編集してください。

---

## 基本操作

### メニューバー

画面上部のメニューバーから各機能にアクセスします。

#### ログイン/管理者セットアップ画面のメニュー

- **設定 > 言語**: 日本語⇔英語の切り替え
- **設定 > フォントサイズ**: 文字サイズの変更
- **ファイル > 終了**: アプリケーション終了

#### 管理画面のメニュー

- **ファイル**
  - ログイン: ログイン画面に戻る
  - 終了: アプリケーション終了
- **管理**: 各種管理機能のサブメニュー
  - ユーザー管理
  - マスタ管理
    - 費目管理
    - 口座管理
    - 店舗管理
    - メーカー管理
    - 商品管理
  - 入出金管理
- **集計**: 集計機能のサブメニュー
  - 日次集計
  - 週次集計
  - 月次集計
  - 年次集計
  - 期間別集計
- **設定**
  - 言語: 日本語⇔英語の切り替え
  - フォントサイズ: 文字サイズの変更

### フォントサイズの変更

1. メニューバーの「設定」> 「フォントサイズ」をクリック
2. プリセット（小・中・大）またはカスタムサイズを選択
3. 「適用」ボタンをクリック

設定はアプリケーション全体に反映されます。

### 言語の切り替え

1. メニューバーの「設定」> 「言語」をクリック
2. 日本語または英語を選択

すぐに画面の言語が切り替わります。

---

## ユーザー管理

### ユーザーの役割

- **管理者 (ADMIN)**: 全ての機能にアクセス可能、他のユーザーを管理
- **一般ユーザー (USER)**: 自分のデータのみ管理可能

### 一般ユーザーの追加

1. メニュー「管理」→「ユーザー管理」を選択
2. 「新規ユーザー追加」ボタンをクリック
3. 以下を入力：
   - **ユーザー名**: 3-20文字、英数字とアンダースコア
   - **パスワード**: 最低16文字
   - **役割**: 一般ユーザー (デフォルト)
4. 「保存」ボタンをクリック

新規ユーザーには、デフォルト費目が自動的に設定されます。

### ユーザー情報の編集

1. ユーザー一覧から編集するユーザーの「編集」ボタンをクリック
2. ユーザー名を変更（変更不可の場合あり）
3. 「保存」ボタンをクリック

### パスワードの変更

1. ユーザー一覧から該当ユーザーの「パスワード変更」ボタンをクリック
2. 新しいパスワードを入力（最低16文字）
3. 「保存」ボタンをクリック

### ユーザーの削除

1. ユーザー一覧から削除するユーザーの「削除」ボタンをクリック
2. 確認ダイアログで「OK」をクリック

**注意**: ユーザーを削除すると、関連する全てのデータ（入出金・費目・口座等）も削除されます。

---

## 費目管理

### 費目の構造

費目は3階層で管理されます：

1. **大分類 (CATEGORY1)**: 支出 (EXPENSE) / 収入 (INCOME) / 振替 (TRANSFER)
   - 固定で変更不可
2. **中分類 (CATEGORY2)**: 食費・交通費など（20種類のデフォルト）
   - 追加・編集・並び替え可能
3. **小分類 (CATEGORY3)**: 外食・自炊など（126種類のデフォルト）
   - 追加・編集・並び替え可能

### 中分類の追加

1. メニュー「管理」→「費目管理」を選択
2. 大分類（支出/収入/振替）の「サブカテゴリ追加」ボタンをクリック
3. 以下を入力：
   - **名前（日本語）**: 中分類の日本語名
   - **名前（英語）**: 中分類の英語名
4. 「保存」ボタンをクリック

### 小分類の追加

1. 中分類の「サブカテゴリ追加」ボタンをクリック
2. 以下を入力：
   - **名前（日本語）**: 小分類の日本語名
   - **名前（英語）**: 小分類の英語名
3. 「保存」ボタンをクリック

### 費目の編集

1. 中分類または小分類の「編集」ボタンをクリック
2. 名前を変更
3. 「保存」ボタンをクリック

### 費目の並び替え

1. 費目の「↑」「↓」ボタンをクリックして移動
2. 変更は即座に反映されます

**注意**: 費目は削除できません。入出金データとの整合性を保つためです。

---

## 口座管理

### 口座の追加

1. メニュー「管理」→「口座管理」を選択
2. 「新規口座追加」ボタンをクリック
3. 以下を入力：
   - **口座名**: 任意の名前（例: 現金、みずほ銀行）
   - **初期残高**: 口座の初期残高（任意）
   - **表示順**: 一覧での表示順序
4. 「保存」ボタンをクリック

### テンプレート口座の利用

口座追加時に、以下のテンプレートを選択できます：

- 現金
- 銀行口座
- クレジットカード
- 電子マネー
- その他

テンプレートを選択すると、口座名が自動入力されます。

### 口座の編集

1. 口座一覧から編集する口座の「編集」ボタンをクリック
2. 口座名・表示順を変更
3. 「保存」ボタンをクリック

**注意**: 初期残高は作成時のみ設定可能です。残高の変更は入出金管理で行います。

### 口座の削除

1. 口座一覧から削除する口座の「削除」ボタンをクリック
2. 確認ダイアログで「OK」をクリック

**注意**: 入出金データが関連付けられている口座は削除できません。

---

## 店舗管理

### 店舗の追加

1. メニュー「管理」→「店舗管理」を選択
2. 「新規店舗追加」ボタンをクリック
3. 以下を入力：
   - **店舗名**: 任意の名前（例: セブンイレブン、イオン）
   - **非表示**: チェックすると一覧に表示されなくなります（デフォルト: OFF）
4. 「保存」ボタンをクリック

### 非表示項目の表示/非表示

1. 「非表示項目を表示/隠す」トグルボタンをクリック
2. 非表示項目がグレー表示で表示されます

### 店舗の編集

1. 店舗一覧から編集する店舗の「編集」ボタンをクリック
2. 店舗名・非表示設定を変更
3. 「保存」ボタンをクリック

### 店舗の削除

1. 店舗一覧から削除する店舗の「削除」ボタンをクリック
2. 確認ダイアログで「OK」をクリック

削除された店舗は論理削除（IS_DISABLED=1）され、一覧に表示されなくなります。

---

## メーカー・商品管理

### メーカーの追加

1. メニュー「管理」→「メーカー管理」を選択
2. 「新規メーカー追加」ボタンをクリック
3. 以下を入力：
   - **メーカー名**: 任意の名前（例: コカ・コーラ、トヨタ）
   - **非表示**: チェックすると一覧に表示されなくなります
4. 「保存」ボタンをクリック

### 商品の追加

1. メニュー「管理」→「商品管理」を選択
2. 「新規商品追加」ボタンをクリック
3. 以下を入力：
   - **商品名**: 任意の名前（例: コーラ500ml、プリウス）
   - **メーカー**: ドロップダウンからメーカーを選択
   - **非表示**: チェックすると一覧に表示されなくなります
4. 「保存」ボタンをクリック

### 非表示項目の表示

店舗管理と同様に、「非表示項目を表示/隠す」トグルボタンで切り替えます。

---

## 入出金管理

### 入出金ヘッダーの登録

入出金ヘッダーは、取引全体の情報を管理します。

1. メニュー「管理」→「入出金管理」を選択
2. 「新規追加」ボタンをクリック
3. 以下を入力：
   - **取引日**: カレンダーから日付を選択
   - **大分類**: 支出 / 収入 / 振替
   - **FROM口座**: 出金元口座（支出・振替の場合）
   - **TO口座**: 入金先口座（収入・振替の場合）
   - **店舗**: ドロップダウンから店舗を選択（任意）
   - **合計金額**: 取引の合計金額
   - **メモ**: 取引のメモ（任意）
4. 「保存」ボタンをクリック

### 入出金明細の登録

入出金ヘッダーに対して、詳細な明細を登録します。

1. 入出金一覧から該当ヘッダーの「明細管理」ボタンをクリック
2. 「新規明細追加」ボタンをクリック
3. 以下を入力：
   - **中分類**: ドロップダウンから中分類を選択
   - **小分類**: ドロップダウンから小分類を選択
   - **商品**: ドロップダウンから商品を選択（任意）
   - **数量**: 商品の数量
   - **税率**: 消費税率（8% or 10%）
   - **税抜金額** または **税込金額**: どちらか一方を入力（自動計算）
   - **メモ**: 明細のメモ（任意）
4. 「保存」ボタンをクリック

### 税抜⇔税込の自動計算

- 税抜金額を入力すると、税込金額が自動計算されます
- 税込金額を入力すると、税抜金額が自動計算されます
- 端数処理（切り捨て・切り上げ・四捨五入）は自動検出されます

### フィルター機能

入出金一覧では、以下の条件でフィルタリングできます：

- **日付範囲**: 開始日〜終了日
- **カテゴリ**: 大分類 → 中分類 → 小分類（動的に絞り込み）
- **金額範囲**: 最小金額〜最大金額
- **キーワード**: メモ内のキーワード検索

### 入出金の編集

1. 入出金一覧から編集する取引の「編集」ボタンをクリック
2. 情報を変更
3. 「保存」ボタンをクリック

### 入出金の削除

1. 入出金一覧から削除する取引の「削除」ボタンをクリック
2. 確認ダイアログで「OK」をクリック

**注意**: ヘッダーを削除すると、関連する全ての明細も削除されます。

---

## 集計機能

KakeiBon by Rustでは、5つの集計方法を提供しています。

### 集計方法の選択

| 集計方法 | 用途 | 画面 |
|---------|------|------|
| **月次集計** | 毎月の収支を確認 | 月次集計画面 |
| **日次集計** | 特定日の収支を確認 | 日次集計画面 |
| **週次集計** | 週単位の収支を確認 | 週次集計画面 |
| **年次集計** | 年間収支・会計年度収支を確認 | 年次集計画面 |
| **期間別集計** | 任意期間の収支を確認 | 期間別集計画面 |

### 月次集計

1. メニュー「集計」→「月次集計」を選択
2. **年**と**月**を選択
3. **集計軸**を選択（カテゴリ・口座・店舗）
4. 「集計実行」ボタンをクリック

### 日次集計

1. メニュー「集計」→「日次集計」を選択
2. カレンダーから**日付**を選択（デフォルト: 今日）
3. **集計軸**を選択
4. 「集計実行」ボタンをクリック

### 週次集計

1. メニュー「集計」→「週次集計」を選択
2. カレンダーから**基準日**を選択（デフォルト: 今日）
3. **週の開始曜日**を選択（日曜 or 月曜）
4. **集計軸**を選択
5. 「集計実行」ボタンをクリック

### 年次集計

1. メニュー「集計」→「年次集計」を選択
2. **年**を選択
3. **年度開始月**を選択
   - 暦年: 1月
   - 会計年度（日本）: 4月
4. **集計軸**を選択
5. 「集計実行」ボタンをクリック

### 期間別集計

1. メニュー「集計」→「期間別集計」を選択
2. カレンダーから**開始日**と**終了日**を選択
   - デフォルト: 今月1日〜今日
3. **集計軸**を選択
4. 「集計実行」ボタンをクリック

### 集計結果の見方

集計結果には以下の情報が表示されます：

- **グループ名**: カテゴリ名、口座名、店舗名など
- **合計金額（純増減）**: 収入は加算、支出は減算した純増減額
- **件数**: 該当する取引の件数
- **平均金額**: 合計金額を件数で割った平均額

**注意**:
- 口座別集計のみ、振替取引が含まれます（説明ノート表示）
- その他の集計では、振替は純増減に影響しないため除外されます

---

## ダッシュボード

v1.1.0で追加されたダッシュボード機能では、Chart.jsを使用して収支データをグラフで可視化できます。

### ダッシュボードへのアクセス

1. メニュー「集計」→「ダッシュボード」を選択
2. ダッシュボード画面が表示されます

### 表示されるグラフ

ダッシュボードでは3種類のグラフが表示されます：

#### 1. 円グラフ（カテゴリ別支出内訳）

支出をカテゴリ別に分類し、割合を視覚的に表示します。

- **表示内容**: 各カテゴリの支出額と全体に占める割合
- **用途**: どのカテゴリに最も支出しているか一目で把握

#### 2. 棒グラフ（月次収支比較）

月ごとの収入と支出を棒グラフで比較表示します。

- **表示内容**: 各月の収入（青）と支出（赤）
- **用途**: 月ごとの収支バランスを比較

#### 3. 折れ線グラフ（月次トレンド）

収入・支出・残高の推移を折れ線グラフで表示します。

- **表示内容**:
  - 収入の推移（青線）
  - 支出の推移（赤線）
  - 残高の推移（緑線）
- **用途**: 長期的な収支トレンドの把握

### ダッシュボードの活用方法

- **月初に確認**: 先月の収支状況を振り返る
- **予算管理**: カテゴリ別支出を確認し、予算超過をチェック
- **トレンド分析**: 長期的な収支パターンを把握

---

## 設定

現在、以下の設定が利用可能です：

- **言語**: 日本語 / 英語
- **フォントサイズ**: 小 / 中 / 大 / カスタム

設定はメニューバーから変更できます。

---

## トラブルシューティング

### ログインできない

- ユーザー名・パスワードを確認してください
- パスワードは最低16文字必要です
- 管理者が作成されていない場合は、管理者セットアップ画面が表示されます

### データが表示されない

- フィルター条件を確認してください
- 「非表示項目を表示」トグルがOFFになっている可能性があります
- データベースファイル（kakebon.db）が破損している可能性があります

### 集計結果が正しくない

- 入出金データの大分類（支出/収入/振替）を確認してください
- 日付範囲を確認してください
- 口座別集計の場合、振替が含まれることに注意してください

### アプリケーションが起動しない

- 必須ライブラリがインストールされているか確認してください
- ビルドが正しく完了しているか確認してください
- 詳細は[トラブルシューティングガイド](TROUBLESHOOTING.md)を参照してください

---

## さらに詳しい情報

- **セットアップガイド**: [SETUP_GUIDE.md](SETUP_GUIDE.md)
- **クイックスタート**: [QUICK_START_GUIDE.md](QUICK_START_GUIDE.md)
- **集計機能詳細**: [AGGREGATION_USER_GUIDE.md](AGGREGATION_USER_GUIDE.md)
- **トラブルシューティング**: [TROUBLESHOOTING.md](TROUBLESHOOTING.md)
- **開発者向けドキュメント**: [docs/developer/](../../developer/)

---

**最終更新**: 2026-01-18 JST
